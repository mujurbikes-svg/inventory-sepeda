<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventaris Toko Sepeda</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --dark-color: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            padding-bottom: 70px;
        }
        
        .navbar {
            background-color: var(--dark-color);
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
            border: none;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-unassembled {
            background-color: var(--warning-color);
            color: white;
        }
        
        .status-assembled {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .status-sold {
            background-color: var(--danger-color);
            color: white;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }
        
        .nav-item {
            text-align: center;
            padding: 10px 0;
            flex: 1;
            cursor: pointer;
        }
        
        .nav-item.active {
            color: var(--primary-color);
        }
        
        .nav-icon {
            font-size: 1.5rem;
            display: block;
        }
        
        .nav-label {
            font-size: 0.8rem;
            margin-top: 2px;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        .bike-item {
            transition: transform 0.2s;
        }
        
        .bike-item:hover {
            transform: translateY(-2px);
        }
        
        .qr-container {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 300px;
        }
        
        .form-section {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }
        
        .qr-label-container {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-top: 10px;
        }
        
        .qr-code-small {
            width: 80px;
            flex-shrink: 0;
        }
        
        .qr-info {
            flex: 1;
            text-align: left;
            font-size: 11px;
            line-height: 1.2;
            padding-top: 5px;
        }
        
        .qr-info strong {
            display: block;
            margin-bottom: 3px;
            font-size: 12px;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            #printable-qr, #printable-qr * {
                visibility: visible;
            }
            #printable-qr {
                position: absolute;
                left: 0;
                top: 0;
                width: 58mm;
                padding: 5px;
            }
        }
        
        .printable-qr {
            width: 58mm;
            padding: 5px;
            border: 1px dashed #ccc;
            margin: 10px auto;
            background: white;
        }
        
        .package-unit-input {
            margin-top: 8px;
        }
        
        .unit-count-badge {
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            position: absolute;
            top: -8px;
            right: -8px;
        }
        
        .quick-scan-btn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1001;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .search-box {
            margin-bottom: 15px;
        }
        
        .bike-card-content {
            position: relative;
        }
        
        .bike-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .image-upload-container {
            position: relative;
            margin-bottom: 15px;
        }
        
        .image-preview {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 5px;
            border: 2px dashed #ddd;
            display: none;
        }
        
        .image-placeholder {
            width: 100%;
            height: 150px;
            border: 2px dashed #ddd;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: #6c757d;
            cursor: pointer;
        }
        
        .image-placeholder i {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        #camera-input {
            display: none;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .action-buttons .btn {
            flex: 1;
            min-width: 120px;
        }
        
        .tab-content {
            margin-top: 15px;
        }
        
        .custom-tab {
            display: none;
        }
        
        .custom-tab.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Quick Scan Button -->
    <button class="quick-scan-btn" id="quick-scan-btn" title="Quick Scan QR">
        <i class="fas fa-qrcode"></i>
    </button>

    <!-- Navbar -->
    <nav class="navbar navbar-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="fas fa-bicycle me-2"></i>Inventaris Sepeda
            </span>
            <button class="btn btn-outline-light btn-sm" id="export-btn">
                <i class="fas fa-download"></i>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-3">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <h4 class="mb-3">Dashboard Inventaris</h4>
            
            <div class="row mb-4">
                <div class="col-4">
                    <div class="card text-center bg-warning text-white">
                        <div class="card-body py-3">
                            <h5 id="unassembled-count">0</h5>
                            <small>Belum Rakit</small>
                        </div>
                    </div>
                </div>
                <div class="col-4">
                    <div class="card text-center bg-success text-white">
                        <div class="card-body py-3">
                            <h5 id="assembled-count">0</h5>
                            <small>Sudah Rakit</small>
                        </div>
                    </div>
                </div>
                <div class="col-4">
                    <div class="card text-center bg-danger text-white">
                        <div class="card-body py-3">
                            <h5 id="low-stock-count">0</h5>
                            <small>Stok Tipis</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Search Box -->
            <div class="search-box">
                <div class="input-group">
                    <input type="text" class="form-control" id="search-input" placeholder="Cari sepeda...">
                    <button class="btn btn-outline-secondary" type="button" id="clear-search">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="d-flex mb-3">
                <button class="btn btn-outline-primary me-2 active filter-btn" data-status="all">Semua</button>
                <button class="btn btn-outline-warning me-2 filter-btn" data-status="unassembled">Belum Rakit</button>
                <button class="btn btn-outline-success me-2 filter-btn" data-status="assembled">Sudah Rakit</button>
            </div>
            
            <div id="bike-list">
                <!-- Daftar sepeda akan dimuat di sini -->
            </div>
        </div>

        <!-- Add Bike Page -->
        <div id="add-bike-page" class="page">
            <h4 class="mb-3">Tambah Sepeda Baru</h4>
            
            <div class="form-section">
                <form id="bike-form">
                    <!-- Image Upload -->
                    <div class="image-upload-container">
                        <div class="image-placeholder" id="image-placeholder">
                            <i class="fas fa-camera"></i>
                            <span>Ambil Foto atau Upload Gambar</span>
                        </div>
                        <img id="image-preview" class="image-preview" alt="Preview">
                        <input type="file" id="camera-input" accept="image/*" capture="environment">
                    </div>
                    
                    <div class="mb-3">
                        <label for="bike-name" class="form-label">Nama Sepeda</label>
                        <input type="text" class="form-control" id="bike-name" required style="text-transform: uppercase;">
                    </div>
                    
                    <div class="mb-3">
                        <label for="bike-type" class="form-label">Tipe</label>
                        <select class="form-select" id="bike-type" required>
                            <option value="">Pilih Tipe</option>
                        </select>
                        <div class="form-text">
                            <a href="#" id="add-type-btn">+ Tambah tipe baru</a>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="bike-size" class="form-label">Ukuran</label>
                        <select class="form-select" id="bike-size" required>
                            <option value="">Pilih Ukuran</option>
                        </select>
                        <div class="form-text">
                            <a href="#" id="add-size-btn">+ Tambah ukuran baru</a>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="bike-supplier" class="form-label">Supplier</label>
                        <select class="form-select" id="bike-supplier" required>
                            <option value="">Pilih Supplier</option>
                        </select>
                        <div class="form-text">
                            <a href="#" id="add-supplier-btn">+ Tambah supplier baru</a>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="bike-package" class="form-label">Kemasan</label>
                        <select class="form-select" id="bike-package" required>
                            <option value="">Pilih Kemasan</option>
                        </select>
                        <div class="form-text">
                            <a href="#" id="add-package-btn">+ Tambah kemasan baru</a>
                        </div>
                    </div>
                    
                    <div class="mb-3 package-unit-input">
                        <label for="units-per-package" class="form-label">Unit per Kemasan</label>
                        <input type="number" class="form-control" id="units-per-package" value="1" min="1" required>
                        <div class="form-text">Jumlah unit dalam satu kemasan</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="package-quantity" class="form-label">Jumlah Kemasan</label>
                        <input type="number" class="form-control" id="package-quantity" value="1" min="1" required>
                        <div class="form-text">Total kemasan yang diterima</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="arrival-date" class="form-label">Tanggal Kedatangan</label>
                        <input type="date" class="form-control" id="arrival-date" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100">Simpan Sepeda</button>
                </form>
            </div>
        </div>

        <!-- QR Tools Page -->
        <div id="qr-page" class="page">
            <h4 class="mb-3">QR Code Tools</h4>
            
            <div class="d-flex mb-3">
                <button class="btn btn-outline-primary me-2 active" id="generate-tab-btn">Generate QR</button>
                <button class="btn btn-outline-secondary" id="scan-tab-btn">Scan QR</button>
            </div>
            
            <div class="tab-content">
                <!-- Generate QR Tab -->
                <div id="generate-tab" class="custom-tab active">
                    <div class="mb-3">
                        <label for="bike-select" class="form-label">Pilih Sepeda</label>
                        <select class="form-select" id="bike-select">
                            <option value="">Pilih sepeda untuk generate QR</option>
                        </select>
                    </div>
                    
                    <div id="qr-code-container" class="qr-container" style="display: none;">
                        <div id="printable-qr" class="printable-qr">
                            <div class="qr-label-container">
                                <div class="qr-code-small" id="qrcode"></div>
                                <div class="qr-info">
                                    <strong id="qr-bike-name"></strong>
                                    <div id="qr-bike-type-size"></div>
                                    <div id="qr-bike-supplier"></div>
                                    <div id="qr-bike-arrival"></div>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex gap-2 mt-2">
                            <button class="btn btn-outline-primary flex-fill" id="print-qr">
                                <i class="fas fa-print me-1"></i> Print Label
                            </button>
                            <button class="btn btn-outline-success flex-fill" id="download-qr">
                                <i class="fas fa-download me-1"></i> Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Scan QR Tab -->
                <div id="scan-tab" class="custom-tab">
                    <div class="mb-3">
                        <p>Scan QR Code untuk melihat informasi sepeda.</p>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Fitur scan menggunakan kamera membutuhkan akses kamera di perangkat Anda.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <button class="btn btn-primary w-100 mb-2" id="camera-scan-btn">
                            <i class="fas fa-camera me-1"></i> Gunakan Kamera
                        </button>
                        <button class="btn btn-secondary w-100" id="upload-scan-btn">
                            <i class="fas fa-upload me-1"></i> Upload Gambar QR
                        </button>
                        <input type="file" id="file-input" accept="image/*" style="display: none;">
                    </div>
                    
                    <div id="camera-container" style="display: none;">
                        <video id="camera-feed" autoplay playsinline style="width: 100%; border-radius: 10px;"></video>
                        <div style="position: relative; text-align: center; margin-top: 10px;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 200px; height: 200px; border: 2px solid white; border-radius: 10px; box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.3);"></div>
                        </div>
                        <button class="btn btn-danger w-100 mt-2" id="stop-camera-btn">
                            <i class="fas fa-stop me-1"></i> Hentikan Kamera
                        </button>
                    </div>
                    
                    <div id="scan-result" class="mt-3 text-center"></div>
                </div>
            </div>
        </div>

        <!-- Data Master Page -->
        <div id="master-data-page" class="page">
            <h4 class="mb-3">Data Master</h4>
            
            <div class="d-flex mb-3 flex-wrap">
                <button class="btn btn-outline-primary me-2 mb-2 active" id="type-tab-btn">Tipe</button>
                <button class="btn btn-outline-secondary me-2 mb-2" id="size-tab-btn">Ukuran</button>
                <button class="btn btn-outline-secondary me-2 mb-2" id="supplier-tab-btn">Supplier</button>
                <button class="btn btn-outline-secondary me-2 mb-2" id="package-tab-btn">Kemasan</button>
                <button class="btn btn-outline-secondary mb-2" id="assembler-tab-btn">Perakit</button>
            </div>
            
            <div class="tab-content">
                <!-- Type Tab -->
                <div id="type-tab" class="custom-tab active">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="new-type" placeholder="Tambah tipe baru">
                        <button class="btn btn-primary" type="button" id="save-type">Tambah</button>
                    </div>
                    <ul class="list-group" id="type-list">
                        <!-- Daftar tipe akan dimuat di sini -->
                    </ul>
                </div>
                
                <!-- Size Tab -->
                <div id="size-tab" class="custom-tab">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="new-size" placeholder="Tambah ukuran baru">
                        <button class="btn btn-primary" type="button" id="save-size">Tambah</button>
                    </div>
                    <ul class="list-group" id="size-list">
                        <!-- Daftar ukuran akan dimuat di sini -->
                    </ul>
                </div>
                
                <!-- Supplier Tab -->
                <div id="supplier-tab" class="custom-tab">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="new-supplier" placeholder="Tambah supplier baru">
                        <button class="btn btn-primary" type="button" id="save-supplier">Tambah</button>
                    </div>
                    <ul class="list-group" id="supplier-list">
                        <!-- Daftar supplier akan dimuat di sini -->
                    </ul>
                </div>
                
                <!-- Package Tab -->
                <div id="package-tab" class="custom-tab">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="new-package" placeholder="Tambah kemasan baru">
                        <button class="btn btn-primary" type="button" id="save-package">Tambah</button>
                    </div>
                    <ul class="list-group" id="package-list">
                        <!-- Daftar kemasan akan dimuat di sini -->
                    </ul>
                </div>
                
                <!-- Assembler Tab -->
                <div id="assembler-tab" class="custom-tab">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="new-assembler" placeholder="Tambah perakit baru">
                        <button class="btn btn-primary" type="button" id="save-assembler">Tambah</button>
                    </div>
                    <ul class="list-group" id="assembler-list">
                        <!-- Daftar perakit akan dimuat di sini -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="d-flex">
            <div class="nav-item active" data-page="dashboard-page">
                <i class="nav-icon fas fa-home"></i>
                <div class="nav-label">Dashboard</div>
            </div>
            <div class="nav-item" data-page="add-bike-page">
                <i class="nav-icon fas fa-plus-circle"></i>
                <div class="nav-label">Tambah</div>
            </div>
            <div class="nav-item" data-page="qr-page">
                <i class="nav-icon fas fa-qrcode"></i>
                <div class="nav-label">QR Code</div>
            </div>
            <div class="nav-item" data-page="master-data-page">
                <i class="nav-icon fas fa-cog"></i>
                <div class="nav-label">Data Master</div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="assemblyModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tandai Sepeda Sudah Rakit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="assembly-form">
                        <input type="hidden" id="assembly-bike-ids">
                        <div class="mb-3">
                            <label for="assembly-count" class="form-label">Jumlah yang Dirakit</label>
                            <input type="number" class="form-control" id="assembly-count" min="1" required>
                            <div class="form-text" id="assembly-max-count">Maksimal: 0 unit</div>
                        </div>
                        <div class="mb-3">
                            <label for="assembly-date" class="form-label">Tanggal Perakitan</label>
                            <input type="date" class="form-control" id="assembly-date" required>
                        </div>
                        <div class="mb-3">
                            <label for="assembler" class="form-label">Nama Perakit</label>
                            <select class="form-select" id="assembler" required>
                                <option value="">Pilih Perakit</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success w-100">Simpan Perakitan</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="saleModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tandai Sepeda Terjual</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="sale-form">
                        <input type="hidden" id="sale-bike-ids">
                        <div class="mb-3">
                            <label for="sale-count" class="form-label">Jumlah yang Terjual</label>
                            <input type="number" class="form-control" id="sale-count" min="1" required>
                            <div class="form-text" id="sale-max-count">Maksimal: 0 unit</div>
                        </div>
                        <div class="mb-3">
                            <label for="sale-date" class="form-label">Tanggal Penjualan</label>
                            <input type="date" class="form-control" id="sale-date" required>
                        </div>
                        <button type="submit" class="btn btn-danger w-100">Simpan Penjualan</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="editBikeModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Data Sepeda</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-bike-form">
                        <input type="hidden" id="edit-bike-id">
                        <div class="mb-3">
                            <label for="edit-bike-name" class="form-label">Nama Sepeda</label>
                            <input type="text" class="form-control" id="edit-bike-name" required style="text-transform: uppercase;">
                        </div>
                        <div class="mb-3">
                            <label for="edit-bike-type" class="form-label">Tipe</label>
                            <select class="form-select" id="edit-bike-type" required>
                                <option value="">Pilih Tipe</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit-bike-size" class="form-label">Ukuran</label>
                            <select class="form-select" id="edit-bike-size" required>
                                <option value="">Pilih Ukuran</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit-bike-supplier" class="form-label">Supplier</label>
                            <select class="form-select" id="edit-bike-supplier" required>
                                <option value="">Pilih Supplier</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit-bike-package" class="form-label">Kemasan</label>
                            <select class="form-select" id="edit-bike-package" required>
                                <option value="">Pilih Kemasan</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit-arrival-date" class="form-label">Tanggal Kedatangan</label>
                            <input type="date" class="form-control" id="edit-arrival-date" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Update Data Sepeda</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap & jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Data Storage
        let bikes = JSON.parse(localStorage.getItem('bikes')) || [];
        let masterData = JSON.parse(localStorage.getItem('masterData')) || {
            types: ['Mountain Bike', 'Road Bike', 'City Bike', 'BMX'],
            sizes: ['16"', '18"', '20"', '24"', '26"', '27.5"', '29"'],
            suppliers: ['Supplier A', 'Supplier B', 'Supplier C'],
            packages: ['Kardus', 'Plastik', 'Kayu'],
            assemblers: ['Budi', 'Sari', 'Ahmad']
        };

        // Initialize App
        $(document).ready(function() {
            console.log("Aplikasi dimulai...");
            
            // Initialize data
            if (!localStorage.getItem('masterData')) {
                localStorage.setItem('masterData', JSON.stringify(masterData));
            }
            
            // Set current date
            const today = new Date().toISOString().split('T')[0];
            $('#arrival-date').val(today);
            $('#assembly-date').val(today);
            $('#sale-date').val(today);
            
            // Load initial data
            loadMasterDataToForms();
            loadBikeList();
            updateDashboardCounts();
            loadBikeSelect();
            loadAssemblers();
            loadMasterDataLists();
            
            // Bottom Navigation
            $('.bottom-nav .nav-item').on('click', function() {
                console.log("Navigasi diklik:", $(this).data('page'));
                $('.bottom-nav .nav-item').removeClass('active');
                $(this).addClass('active');
                
                const pageId = $(this).data('page');
                $('.page').removeClass('active');
                $('#' + pageId).addClass('active');
            });
            
            // QR Page Tabs
            $('#generate-tab-btn').on('click', function() {
                $('#generate-tab-btn').addClass('btn-outline-primary active');
                $('#scan-tab-btn').removeClass('btn-outline-primary active').addClass('btn-outline-secondary');
                $('#generate-tab').addClass('active');
                $('#scan-tab').removeClass('active');
            });
            
            $('#scan-tab-btn').on('click', function() {
                $('#scan-tab-btn').addClass('btn-outline-primary active');
                $('#generate-tab-btn').removeClass('btn-outline-primary active').addClass('btn-outline-secondary');
                $('#scan-tab').addClass('active');
                $('#generate-tab').removeClass('active');
            });
            
            // Master Data Page Tabs
            $('#type-tab-btn').on('click', function() {
                setActiveMasterTab('type');
            });
            
            $('#size-tab-btn').on('click', function() {
                setActiveMasterTab('size');
            });
            
            $('#supplier-tab-btn').on('click', function() {
                setActiveMasterTab('supplier');
            });
            
            $('#package-tab-btn').on('click', function() {
                setActiveMasterTab('package');
            });
            
            $('#assembler-tab-btn').on('click', function() {
                setActiveMasterTab('assembler');
            });
            
            // Filter buttons
            $('.filter-btn').on('click', function() {
                $('.filter-btn').removeClass('active');
                $(this).addClass('active');
                const status = $(this).data('status');
                loadBikeList(status);
            });
            
            // Search functionality
            $('#search-input').on('input', function() {
                loadBikeList();
            });
            
            $('#clear-search').on('click', function() {
                $('#search-input').val('');
                loadBikeList();
            });
            
            // Image upload
            $('#image-placeholder').on('click', function() {
                $('#camera-input').click();
            });
            
            $('#camera-input').on('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        $('#image-preview').attr('src', e.target.result).show();
                        $('#image-placeholder').hide();
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Form submissions
            $('#bike-form').on('submit', function(e) {
                e.preventDefault();
                addNewBike();
            });
            
            $('#edit-bike-form').on('submit', function(e) {
                e.preventDefault();
                updateBike();
            });
            
            $('#assembly-form').on('submit', function(e) {
                e.preventDefault();
                markAsAssembled();
            });
            
            $('#sale-form').on('submit', function(e) {
                e.preventDefault();
                markAsSold();
            });
            
            // Master data additions
            $('#save-type').on('click', function() {
                addMasterDataItem('types', $('#new-type'));
            });
            
            $('#save-size').on('click', function() {
                addMasterDataItem('sizes', $('#new-size'));
            });
            
            $('#save-supplier').on('click', function() {
                addMasterDataItem('suppliers', $('#new-supplier'));
            });
            
            $('#save-package').on('click', function() {
                addMasterDataItem('packages', $('#new-package'));
            });
            
            $('#save-assembler').on('click', function() {
                addMasterDataItem('assemblers', $('#new-assembler'));
            });
            
            // Quick add links
            $('#add-type-btn').on('click', function(e) {
                e.preventDefault();
                navigateToMasterTab('type');
            });
            
            $('#add-size-btn').on('click', function(e) {
                e.preventDefault();
                navigateToMasterTab('size');
            });
            
            $('#add-supplier-btn').on('click', function(e) {
                e.preventDefault();
                navigateToMasterTab('supplier');
            });
            
            $('#add-package-btn').on('click', function(e) {
                e.preventDefault();
                navigateToMasterTab('package');
            });
            
            // QR Code functions
            $('#bike-select').on('change', function() {
                generateQRCode();
            });
            
            $('#print-qr').on('click', function() {
                printQRCode();
            });
            
            $('#download-qr').on('click', function() {
                downloadQRCode();
            });
            
            // QR Scanning
            $('#camera-scan-btn').on('click', function() {
                startCameraScan();
            });
            
            $('#upload-scan-btn').on('click', function() {
                $('#file-input').click();
            });
            
            $('#file-input').on('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    scanQRFromImage(file);
                }
            });
            
            $('#stop-camera-btn').on('click', function() {
                stopCamera();
            });
            
            // Export data
            $('#export-btn').on('click', function() {
                exportData();
            });
            
            // Event delegation for dynamic buttons
            $(document).on('click', '.assemble-btn', function() {
                const bikeIds = JSON.parse($(this).data('ids'));
                const maxCount = $(this).data('count');
                $('#assembly-bike-ids').val(JSON.stringify(bikeIds));
                $('#assembly-count').val(maxCount).attr('max', maxCount);
                $('#assembly-max-count').text(`Maksimal: ${maxCount} unit`);
                new bootstrap.Modal(document.getElementById('assemblyModal')).show();
            });
            
            $(document).on('click', '.sell-btn', function() {
                const bikeIds = JSON.parse($(this).data('ids'));
                const maxCount = $(this).data('count');
                $('#sale-bike-ids').val(JSON.stringify(bikeIds));
                $('#sale-count').val(maxCount).attr('max', maxCount);
                $('#sale-max-count').text(`Maksimal: ${maxCount} unit`);
                new bootstrap.Modal(document.getElementById('saleModal')).show();
            });
            
            $(document).on('click', '.view-qr-btn', function() {
                const bikeId = $(this).data('id');
                navigateToQRPage(bikeId);
            });
            
            $(document).on('click', '.edit-btn', function() {
                const bikeId = $(this).data('id');
                const bike = bikes.find(b => b.id === bikeId);
                
                if (bike) {
                    $('#edit-bike-id').val(bike.id);
                    $('#edit-bike-name').val(bike.name);
                    $('#edit-bike-type').val(bike.type);
                    $('#edit-bike-size').val(bike.size);
                    $('#edit-bike-supplier').val(bike.supplier);
                    $('#edit-bike-package').val(bike.package);
                    $('#edit-arrival-date').val(bike.arrivalDate);
                    
                    new bootstrap.Modal(document.getElementById('editBikeModal')).show();
                }
            });
            
            // Delete master data items
            $(document).on('click', '.delete-type', function() {
                const item = $(this).data('item');
                deleteMasterDataItem('types', item);
            });
            
            $(document).on('click', '.delete-size', function() {
                const item = $(this).data('item');
                deleteMasterDataItem('sizes', item);
            });
            
            $(document).on('click', '.delete-supplier', function() {
                const item = $(this).data('item');
                deleteMasterDataItem('suppliers', item);
            });
            
            $(document).on('click', '.delete-package', function() {
                const item = $(this).data('item');
                deleteMasterDataItem('packages', item);
            });
            
            $(document).on('click', '.delete-assembler', function() {
                const item = $(this).data('item');
                deleteMasterDataItem('assemblers', item);
            });
            
            console.log("Aplikasi siap digunakan!");
        });
        
        // Helper Functions
        function setActiveMasterTab(tabName) {
            // Update buttons
            $('#type-tab-btn, #size-tab-btn, #supplier-tab-btn, #package-tab-btn, #assembler-tab-btn')
                .removeClass('btn-outline-primary active')
                .addClass('btn-outline-secondary');
            $(`#${tabName}-tab-btn`).removeClass('btn-outline-secondary').addClass('btn-outline-primary active');
            
            // Update tabs
            $('#type-tab, #size-tab, #supplier-tab, #package-tab, #assembler-tab').removeClass('active');
            $(`#${tabName}-tab`).addClass('active');
        }
        
        function navigateToMasterTab(tabName) {
            $('.bottom-nav .nav-item').removeClass('active');
            $('.bottom-nav .nav-item[data-page="master-data-page"]').addClass('active');
            $('.page').removeClass('active');
            $('#master-data-page').addClass('active');
            setActiveMasterTab(tabName);
        }
        
        function navigateToQRPage(bikeId) {
            $('.bottom-nav .nav-item').removeClass('active');
            $('.bottom-nav .nav-item[data-page="qr-page"]').addClass('active');
            $('.page').removeClass('active');
            $('#qr-page').addClass('active');
            $('#generate-tab-btn').click();
            $('#bike-select').val(bikeId).trigger('change');
        }
        
        function loadMasterDataToForms() {
            // Load types
            $('#bike-type, #edit-bike-type').html('<option value="">Pilih Tipe</option>');
            masterData.types.forEach(type => {
                $('#bike-type, #edit-bike-type').append(`<option value="${type}">${type}</option>`);
            });
            
            // Load sizes
            $('#bike-size, #edit-bike-size').html('<option value="">Pilih Ukuran</option>');
            masterData.sizes.forEach(size => {
                $('#bike-size, #edit-bike-size').append(`<option value="${size}">${size}</option>`);
            });
            
            // Load suppliers
            $('#bike-supplier, #edit-bike-supplier').html('<option value="">Pilih Supplier</option>');
            masterData.suppliers.forEach(supplier => {
                $('#bike-supplier, #edit-bike-supplier').append(`<option value="${supplier}">${supplier}</option>`);
            });
            
            // Load packages
            $('#bike-package, #edit-bike-package').html('<option value="">Pilih Kemasan</option>');
            masterData.packages.forEach(pkg => {
                $('#bike-package, #edit-bike-package').append(`<option value="${pkg}">${pkg}</option>`);
            });
        }
        
        function loadAssemblers() {
            $('#assembler').html('<option value="">Pilih Perakit</option>');
            masterData.assemblers.forEach(assembler => {
                $('#assembler').append(`<option value="${assembler}">${assembler}</option>`);
            });
        }
        
        function loadMasterDataLists() {
            // Load types
            $('#type-list').empty();
            masterData.types.forEach(type => {
                $('#type-list').append(`
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${type}
                        <button class="btn btn-sm btn-outline-danger delete-type" data-item="${type}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </li>
                `);
            });
            
            // Load sizes
            $('#size-list').empty();
            masterData.sizes.forEach(size => {
                $('#size-list').append(`
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${size}
                        <button class="btn btn-sm btn-outline-danger delete-size" data-item="${size}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </li>
                `);
            });
            
            // Load suppliers
            $('#supplier-list').empty();
            masterData.suppliers.forEach(supplier => {
                $('#supplier-list').append(`
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${supplier}
                        <button class="btn btn-sm btn-outline-danger delete-supplier" data-item="${supplier}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </li>
                `);
            });
            
            // Load packages
            $('#package-list').empty();
            masterData.packages.forEach(pkg => {
                $('#package-list').append(`
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${pkg}
                        <button class="btn btn-sm btn-outline-danger delete-package" data-item="${pkg}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </li>
                `);
            });
            
            // Load assemblers
            $('#assembler-list').empty();
            masterData.assemblers.forEach(assembler => {
                $('#assembler-list').append(`
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${assembler}
                        <button class="btn btn-sm btn-outline-danger delete-assembler" data-item="${assembler}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </li>
                `);
            });
        }
        
        function deleteMasterDataItem(type, item) {
            if (confirm(`Hapus ${type.slice(0, -1)} "${item}"?`)) {
                masterData[type] = masterData[type].filter(i => i !== item);
                localStorage.setItem('masterData', JSON.stringify(masterData));
                loadMasterDataToForms();
                loadMasterDataLists();
                if (type === 'assemblers') loadAssemblers();
            }
        }
        
        function loadBikeList(status = 'all') {
            $('#bike-list').empty();
            
            let filteredBikes = bikes;
            const searchTerm = $('#search-input').val().toLowerCase();
            
            // Filter by status
            if (status !== 'all') {
                filteredBikes = filteredBikes.filter(bike => bike.status === status);
            }
            
            // Filter by search term
            if (searchTerm) {
                filteredBikes = filteredBikes.filter(bike => 
                    bike.name.toLowerCase().includes(searchTerm) ||
                    bike.type.toLowerCase().includes(searchTerm) ||
                    bike.size.toLowerCase().includes(searchTerm) ||
                    bike.supplier.toLowerCase().includes(searchTerm)
                );
            }
            
            // Group bikes by model
            const bikeGroups = {};
            filteredBikes.forEach(bike => {
                const key = `${bike.name}-${bike.type}-${bike.size}-${bike.supplier}-${bike.package}-${bike.status}-${bike.arrivalDate}`;
                if (!bikeGroups[key]) {
                    bikeGroups[key] = {
                        name: bike.name,
                        type: bike.type,
                        size: bike.size,
                        supplier: bike.supplier,
                        package: bike.package,
                        status: bike.status,
                        arrivalDate: bike.arrivalDate,
                        unitsPerPackage: bike.unitsPerPackage,
                        packageQuantity: bike.packageQuantity,
                        totalUnits: bike.totalUnits,
                        count: 0,
                        bikeIds: [],
                        image: bike.image,
                        assemblyDate: bike.assemblyDate,
                        assembler: bike.assembler,
                        soldDate: bike.soldDate
                    };
                }
                bikeGroups[key].count++;
                bikeGroups[key].bikeIds.push(bike.id);
            });
            
            if (Object.keys(bikeGroups).length === 0) {
                $('#bike-list').html('<div class="text-center text-muted py-4">Tidak ada sepeda</div>');
                return;
            }
            
            Object.values(bikeGroups).forEach(group => {
                let statusBadge = '';
                let actions = '';
                
                if (group.status === 'unassembled') {
                    statusBadge = '<span class="status-badge status-unassembled">Belum Rakit</span>';
                    actions = `
                        <button class="btn btn-sm btn-success assemble-btn" data-ids='${JSON.stringify(group.bikeIds)}' data-count="${group.count}">
                            <i class="fas fa-tools me-1"></i> Tandai Rakit
                        </button>
                    `;
                } else if (group.status === 'assembled') {
                    statusBadge = '<span class="status-badge status-assembled">Sudah Rakit</span>';
                    actions = `
                        <button class="btn btn-sm btn-danger sell-btn" data-ids='${JSON.stringify(group.bikeIds)}' data-count="${group.count}">
                            <i class="fas fa-shopping-cart me-1"></i> Tandai Terjual
                        </button>
                    `;
                } else if (group.status === 'sold') {
                    statusBadge = '<span class="status-badge status-sold">Terjual</span>';
                }
                
                const assemblyInfo = group.assemblyDate ? 
                    `<br>Rakit: ${formatDate(group.assemblyDate)}${group.assembler ? ` oleh ${group.assembler}` : ''}` : '';
                
                const saleInfo = group.soldDate ? 
                    `<br>Terjual: ${formatDate(group.soldDate)}` : '';
                
                $('#bike-list').append(`
                    <div class="card bike-item">
                        <div class="card-body bike-card-content">
                            ${group.count > 1 ? `<div class="unit-count-badge">${group.count}</div>` : ''}
                            ${group.image ? `<img src="${group.image}" class="bike-image" alt="${group.name}">` : ''}
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h5 class="card-title">${group.name}</h5>
                                    <p class="card-text mb-1">
                                        <small class="text-muted">
                                            ${group.type} - ${group.size}<br>
                                            Supplier: ${group.supplier} | Kemasan: ${group.package}
                                            ${group.totalUnits > 1 ? `<br>${group.packageQuantity} kemasan × ${group.unitsPerPackage} unit` : ''}
                                        </small>
                                    </p>
                                    <p class="card-text mb-0">
                                        <small>
                                            Kedatangan: ${formatDate(group.arrivalDate)}
                                            ${assemblyInfo}
                                            ${saleInfo}
                                            <br>Total Unit: ${group.count}
                                        </small>
                                    </p>
                                </div>
                                ${statusBadge}
                            </div>
                            <div class="mt-3 action-buttons">
                                ${actions}
                                <button class="btn btn-sm btn-outline-secondary view-qr-btn" data-id="${group.bikeIds[0]}">
                                    <i class="fas fa-qrcode me-1"></i> QR Code
                                </button>
                                <button class="btn btn-sm btn-outline-primary edit-btn" data-id="${group.bikeIds[0]}">
                                    <i class="fas fa-edit me-1"></i> Edit
                                </button>
                            </div>
                        </div>
                    </div>
                `);
            });
        }
        
        function updateDashboardCounts() {
            const unassembledCount = bikes.filter(bike => bike.status === 'unassembled').length;
            const assembledCount = bikes.filter(bike => bike.status === 'assembled').length;
            const lowStockCount = bikes.filter(bike => {
                const sameModelBikes = bikes.filter(b => 
                    b.name === bike.name && 
                    b.type === bike.type && 
                    b.size === bike.size && 
                    b.supplier === bike.supplier
                );
                return sameModelBikes.length <= 2;
            }).length;
            
            $('#unassembled-count').text(unassembledCount);
            $('#assembled-count').text(assembledCount);
            $('#low-stock-count').text(lowStockCount);
        }
        
        function loadBikeSelect() {
            $('#bike-select').html('<option value="">Pilih sepeda untuk generate QR</option>');
            bikes.forEach(bike => {
                const unitInfo = bike.totalUnits > 1 ? 
                    ` (Unit ${bike.unitNumber}/${bike.totalUnits})` : '';
                $('#bike-select').append(`<option value="${bike.id}">${bike.name}${unitInfo}</option>`);
            });
        }
        
        function addNewBike() {
            const unitsPerPackage = parseInt($('#units-per-package').val());
            const packageQuantity = parseInt($('#package-quantity').val());
            const totalUnits = unitsPerPackage * packageQuantity;
            const bikeImage = $('#image-preview').attr('src') || '';
            const today = new Date().toISOString().split('T')[0];
            
            // Create multiple bike entries based on total units
            for (let i = 0; i < totalUnits; i++) {
                const bikeData = {
                    id: Date.now().toString() + '-' + i,
                    name: $('#bike-name').val().toUpperCase(),
                    type: $('#bike-type').val(),
                    size: $('#bike-size').val(),
                    supplier: $('#bike-supplier').val(),
                    package: $('#bike-package').val(),
                    unitsPerPackage: unitsPerPackage,
                    packageQuantity: packageQuantity,
                    unitNumber: i + 1,
                    totalUnits: totalUnits,
                    arrivalDate: $('#arrival-date').val(),
                    assemblyDate: null,
                    soldDate: null,
                    status: 'unassembled',
                    image: bikeImage,
                    assembler: null
                };
                
                bikes.push(bikeData);
            }
            
            localStorage.setItem('bikes', JSON.stringify(bikes));
            
            // Reset form
            $('#bike-form')[0].reset();
            $('#units-per-package').val(1);
            $('#package-quantity').val(1);
            $('#image-preview').hide();
            $('#image-placeholder').show();
            $('#arrival-date').val(today);
            
            // Show success message
            alert(`Berhasil menambahkan ${totalUnits} unit sepeda!`);
            
            // Update UI
            loadBikeList();
            updateDashboardCounts();
            loadBikeSelect();
            
            // Navigate to dashboard
            $('.bottom-nav .nav-item').removeClass('active');
            $('.bottom-nav .nav-item[data-page="dashboard-page"]').addClass('active');
            $('.page').removeClass('active');
            $('#dashboard-page').addClass('active');
        }
        
        function updateBike() {
            const bikeId = $('#edit-bike-id').val();
            const bikeIndex = bikes.findIndex(bike => bike.id === bikeId);
            
            if (bikeIndex !== -1) {
                bikes[bikeIndex].name = $('#edit-bike-name').val().toUpperCase();
                bikes[bikeIndex].type = $('#edit-bike-type').val();
                bikes[bikeIndex].size = $('#edit-bike-size').val();
                bikes[bikeIndex].supplier = $('#edit-bike-supplier').val();
                bikes[bikeIndex].package = $('#edit-bike-package').val();
                bikes[bikeIndex].arrivalDate = $('#edit-arrival-date').val();
                
                localStorage.setItem('bikes', JSON.stringify(bikes));
                
                $('#editBikeModal').modal('hide');
                loadBikeList();
                loadBikeSelect();
                alert('Data sepeda berhasil diupdate!');
            }
        }
        
        function markAsAssembled() {
            const bikeIds = JSON.parse($('#assembly-bike-ids').val());
            const assemblyCount = parseInt($('#assembly-count').val());
            const assemblyDate = $('#assembly-date').val();
            const assembler = $('#assembler').val();
            
            // Mark specified number of bikes as assembled
            let count = 0;
            bikeIds.forEach(bikeId => {
                if (count < assemblyCount) {
                    const bikeIndex = bikes.findIndex(bike => bike.id === bikeId && bike.status === 'unassembled');
                    if (bikeIndex !== -1) {
                        bikes[bikeIndex].status = 'assembled';
                        bikes[bikeIndex].assemblyDate = assemblyDate;
                        bikes[bikeIndex].assembler = assembler;
                        count++;
                    }
                }
            });
            
            localStorage.setItem('bikes', JSON.stringify(bikes));
            
            $('#assemblyModal').modal('hide');
            loadBikeList();
            updateDashboardCounts();
            alert(`${count} unit sepeda berhasil ditandai sebagai sudah dirakit!`);
        }
        
        function markAsSold() {
            const bikeIds = JSON.parse($('#sale-bike-ids').val());
            const saleCount = parseInt($('#sale-count').val());
            const saleDate = $('#sale-date').val();
            
            // Mark specified number of bikes as sold
            let count = 0;
            bikeIds.forEach(bikeId => {
                if (count < saleCount) {
                    const bikeIndex = bikes.findIndex(bike => bike.id === bikeId && bike.status === 'assembled');
                    if (bikeIndex !== -1) {
                        bikes[bikeIndex].status = 'sold';
                        bikes[bikeIndex].soldDate = saleDate;
                        count++;
                    }
                }
            });
            
            localStorage.setItem('bikes', JSON.stringify(bikes));
            
            $('#saleModal').modal('hide');
            loadBikeList();
            updateDashboardCounts();
            alert(`${count} unit sepeda berhasil ditandai sebagai terjual!`);
        }
        
        function addMasterDataItem(type, inputElement) {
            const newItem = inputElement.val().trim();
            if (newItem && !masterData[type].includes(newItem)) {
                masterData[type].push(newItem);
                localStorage.setItem('masterData', JSON.stringify(masterData));
                inputElement.val('');
                loadMasterDataToForms();
                loadMasterDataLists();
                if (type === 'assemblers') loadAssemblers();
            }
        }
        
        function generateQRCode() {
            const bikeId = $('#bike-select').val();
            if (bikeId) {
                const bike = bikes.find(b => b.id === bikeId);
                if (bike) {
                    $('#qr-code-container').show();
                    $('#qrcode').empty();
                    
                    // Generate QR Code using qrcode-generator library
                    const qr = qrcode(0, 'M');
                    qr.addData(bikeId);
                    qr.make();
                    
                    $('#qrcode').html(qr.createImgTag(2));
                    $('#qr-bike-name').text(bike.name);
                    $('#qr-bike-type-size').text(`${bike.type} - ${bike.size}`);
                    $('#qr-bike-supplier').text(`Supplier: ${bike.supplier}`);
                    $('#qr-bike-arrival').text(`Tgl: ${formatDate(bike.arrivalDate)}`);
                }
            } else {
                $('#qr-code-container').hide();
            }
        }
        
        function printQRCode() {
            const printContent = document.getElementById('printable-qr').innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
            
            // Reload the page to restore functionality
            location.reload();
        }
        
        function downloadQRCode() {
            const img = document.querySelector('#qrcode img');
            if (img) {
                const bikeName = $('#qr-bike-name').text();
                const link = document.createElement('a');
                link.download = `qr-${bikeName.replace(/\s+/g, '-')}.png`;
                link.href = img.src;
                link.click();
            }
        }
        
        // QR Scanning functions (simplified for now)
        function startCameraScan() {
            $('#camera-container').show();
            $('#scan-result').html('<div class="alert alert-info">Fitur scan kamera dalam pengembangan...</div>');
        }
        
        function scanQRFromImage(file) {
            $('#scan-result').html('<div class="alert alert-info">Memproses gambar QR code...</div>');
            // Simulate processing
            setTimeout(() => {
                $('#scan-result').html('<div class="alert alert-warning">Fitur scan dari gambar dalam pengembangan...</div>');
            }, 1500);
        }
        
        function stopCamera() {
            $('#camera-container').hide();
        }
        
        function exportData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify({
                bikes: bikes,
                masterData: masterData
            }, null, 2));
            
            const downloadAnchor = document.createElement('a');
            downloadAnchor.setAttribute("href", dataStr);
            downloadAnchor.setAttribute("download", "inventaris-sepeda-backup.json");
            document.body.appendChild(downloadAnchor);
            downloadAnchor.click();
            downloadAnchor.remove();
        }
        
        function formatDate(dateString) {
            if (!dateString) return '-';
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            return new Date(dateString).toLocaleDateString('id-ID', options);
        }
    </script>
</body>
</html>
